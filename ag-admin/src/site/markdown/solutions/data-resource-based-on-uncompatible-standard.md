数据资源化的效率及数据抽取问题
====================

> 作者：温富建，2016.03.07

背景
---------------------

在分析背景之前先看两个原则

#### 健康档案数据标准制定原则

> 内部交互，以细粒度数据集为单位，包括数据采集
> 外部交互，以健康档案为单位
> 数据元与数据集只允许增加（在标识命名空间按规定编码），不允许删除，但可以作废

但是在健康档案数据标准0.1版本制作时并未完全遵守此规范，主要具体问题：
- 混合了CDA文档，比如病案首页
- 数据集分配不规范：出院诊断与入院诊断有单独的数据集，但是其他的诊断却没有一个独立的数据集，正常情况是所有的诊断应该有一个数据集

#### 健康档案资源化规则

> 静态数据以数据集为蓝本
> 动态数据根据业务规则生成

二者共同形成资源视图。

#### 问题

当资源化时，由于数据标准的不一致性，无法将数据以简单的规则整合成统一的资源。例如，由于诊断数据在前后版本的数据分散位置不一致，
无法将所有的诊断以同一个数据集的方式统一做整合。又因为对前端应用及用户（患者，医生）而言数据没有版本概念。
这就造成无法直接使用资源化的数据。

解决方案及优缺点讨论
---------------------

鉴于数据无法统一资源化的原因是由于采集标准未按制定原则造成的。我们提出两种处理方案

### 方案一：整理历史数据，以1.0版本为准。新数据标准制定严格按照原则制订，优化动态数据抽取业务逻辑

#### 整理历史数据

此方案的出发点是1.0版本的数据是经过实践检验的，对门诊/住院数据标准做了更合理的划分，并将病案首页数据集作废（病案首页的数据其实是就诊数据的汇总），
增加诊断数据（统一出院诊断与入院诊断数据集）以及护理体征数据集。

对于0.1版本数据：

- 病案首页部分可以拆分至其他数据集
- 入院诊断与出院诊断整合至诊断数据集

此方案实行后，以后的数据标准必须严格按原则制订，**产品部**需要集中精力应付每次业务领域扩展时数据标准的制订工作。

#### 优化资源动态整合方式

在完全遵守数据标准扩展的原则上，对数据资源化的工作更多集中在后期数据动态生成上。

#### 优点

不用二次存储数据，减少数据冗余。

#### 缺点

若对资源化的业务逻辑效率低，会影响用户体验。

### 方案二：尊重历史版本数据，按主题制作静态化资源

此方案出发眯是以后的数据标准无法按原则制订。

在这种情况下，数据标准

#### 优点

不用顾忌标准数据制订的散乱及不可预料的结构变更，根据主题抽取所需要的数据


#### 缺点

数据存储将是平台的巨大负担：若主题有变更，所有的数据均需要重新抽取，巨量数据不可行。


### 对比

相对于方案二，方案一需要在历史数据上做